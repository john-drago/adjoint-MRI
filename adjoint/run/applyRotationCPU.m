function Mnnp1 = applyRotationCPU( Rnn, Mnn, Mnnp1 )
% function that will apply rotation matrix to Mtt to form Mttp1

Mnnp1( :, 1 ) = ...
    Rnn( :, 1 ) .* Mnn( :, 1 ) +... 
    Rnn( :, 4 ) .* Mnn( :, 2 ) +...
    Rnn( :, 7 ) .* Mnn( :, 3 );
Mnnp1( :, 2 ) = ...
    Rnn( :, 2 ) .* Mnn( :, 1 ) +...
    Rnn( :, 5 ) .* Mnn( :, 2 ) +...
    Rnn( :, 8 ) .* Mnn( :, 3 );
Mnnp1( :, 3 ) = ...
    Rnn( :, 3 ) .* Mnn( :, 1 ) +...
    Rnn( :, 6 ) .* Mnn( :, 2 ) +...
    Rnn( :, 9 ) .* Mnn( :, 3 );

end